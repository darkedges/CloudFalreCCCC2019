# Time-Based One-Time Password

A user has an authenticator device to generate one time passwords for logins to their banking website. The implementation contains a fatal flaw.

At the following times, the following codes are generated (all in GMT/UTC):

- Friday, 21 December 2018 16:29:28 - 084342
- Saturday, 22 December 2018 13:11:53 - 411907
- Tuesday, 25 December 2018 12:15:03 - 617041

What code will be generated at precisely midnight of the 1st of January 2019?

## Result

I was disappointed by this one as I thought I would have to do a hunt.

[rfc6238](https://tools.ietf.org/html/rfc6238) contains the details about Time Based One Time Passwords and includes a Java example.

I modified this example to take arguments from the command line and use 6 digits instead of 8.

Compiled via

```bash
javac TOTP.java
```

and executed via

```bash
java TOTP \
    3132333435363738393031323334353637383930 \
    3132333435363738393031323334353637383930313233343536373839303132 \
    3132333435363738393031323334353637383930313233343536373839303132333435363738393031323334
```

it produced

```bash
+---------------+-----------------------+------------------+--------+--------+
|  Time(sec)    |   Time (UTC format)   | Value of T(Hex)  |  TOTP  | Mode   |
+---------------+-----------------------+------------------+--------+--------+
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 113496 | SHA1   |
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 321179 | SHA256 |
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 891973 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 464108 | SHA1   |
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 896062 | SHA256 |
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 747856 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 036852 | SHA1   |
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 456588 | SHA256 |
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 962386 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 084069 | SHA1   |
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 164642 | SHA256 |
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 426599 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
```

I first tried 

```bash
java TOTP \
    0000000000000000000000000000000000000000 \
    0000000000000000000000000000000000000000000000000000000000000000 \
    0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
```

and bam I hit the answer

```bash
+---------------+-----------------------+------------------+--------+--------+
|  Time(sec)    |   Time (UTC format)   | Value of T(Hex)  |  TOTP  | Mode   |
+---------------+-----------------------+------------------+--------+--------+
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 084342 | SHA1   |
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 332801 | SHA256 |
|  1545409768   |  2018-12-21 16:29:28  | 000000000312093A | 164245 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 411907 | SHA1   |
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 723886 | SHA256 |
|  1545484313   |  2018-12-22 13:11:53  | 00000000031212EF | 229223 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 617041 | SHA1   |
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 426815 | SHA256 |
|  1545740103   |  2018-12-25 12:15:03  | 000000000312343E | 616017 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 301554 | SHA1   |
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 230371 | SHA256 |
|  1546300800   |  2019-01-01 00:00:00  | 0000000003127D40 | 161238 | SHA512 |
+---------------+-----------------------+------------------+--------+--------+
```

it is `301554` and it seems they were using an SHA1 key of `0000000000000000000000000000000000000000`
